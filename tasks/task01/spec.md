# Спецификация требований

---

# 1. Цель и область применения

## 1.1 Цель разработки
Разработать однопользовательское веб-приложение, реализующее игру Сапёр, доступное через браузер без установки дополнительного программного обеспечения.

## 1.2 Область применения
Приложение предназначено для пользователей, использующих:
- настольные компьютеры
- ноутбуки
- планшеты
- смартфоны

---

# 2. Общие характеристики системы

## 2.1 Тип системы
Клиентское веб-приложение, работающее в браузере.

## 2.2 Платформа и окружение
- Поддерживаемые платформы: Windows, macOS, Linux, Android, iOS.
- Поддерживаемые браузеры: последние две стабильные версии Chrome, Firefox, Edge, Safari.
- Соединение с интернетом требуется только для первоначальной загрузки приложения.
- После загрузки приложение должно функционировать без постоянного соединения с сервером.
- После завершения игры необходимо интернет соединение для сбора статистики.

## 2.3 Архитектура
- Приложение состоит из frontend и backend приложений.
- Хранение статистики осуществляется на стороне сервера в базе данных PostgreSQL.

---

# 3. Функциональные требования

## 3.1 Игровая логика

### 3.1.1 Генерация поля
1. Игровое поле представляет собой прямоугольную сетку клеток.
2. Мины размещаются случайным образом при старте игры.
3. Первая открытая пользователем клетка не должна содержать мину.
4. После генерации поля каждой клетке без мины присваивается число от 0 до 8, равное количеству мин в соседних клетках.
5. В любой игре пользователь может однозначно выиграть.

### 3.1.2 Открытие клеток
1. При открытии клетки:
    - если клетка содержит мину — игра завершается поражением;
    - если клетка содержит число > 0 — отображается соответствующее число;
    - если клетка содержит 0 — автоматически открываются все соседние клетки (рекурсивно).
2. Повторное открытие уже открытой клетки не изменяет состояние игры.

### 3.1.3 Флажки
1. Пользователь может установить флажок на закрытую клетку.
2. Пользователь может снять установленный флажок.
3. Клетка с флажком не может быть открыта до снятия флажка.

### 3.1.4 Завершение игры
1. Игра завершается поражением при открытии клетки с миной.
2. При поражении:
    - отображаются все мины;
    - дальнейшее взаимодействие с полем блокируется.
3. Игра завершается победой, если открыты все клетки без мин.
4. После победы поле блокируется.
5. После игры с любым исходом отправляется информация об игре 

---

## 3.2 Управление

### 3.2.1 Управление на десктопе
- Левая кнопка мыши (ЛКМ) — открыть клетку.
- Правая кнопка мыши (ПКМ) — установить/снять флажок.

### 3.2.2 Управление на мобильных устройствах
- Короткое касание — открыть клетку.
- Долгое касание (≥ 500 мс) — установить/снять флажок.

---

## 3.3 Уровни сложности

Система должна поддерживать три фиксированных уровня сложности:

| Уровень         | Размер поля | Количество мин |
|----------------|-------------|---------------|
| Новичок       | 9 × 9       | 10            |
| Любитель      | 16 × 16     | 40            |
| Профессионал  | 30 × 30     | 99            |

1. Пользователь выбирает уровень до начала игры.
2. Изменение уровня во время активной игры невозможно.
3. При смене уровня текущая игра сбрасывается.

---

## 3.4 Таймер и счётчики

1. Таймер запускается при первом открытии клетки.
2. Таймер отображается в формате mm:ss
3. Таймер останавливается при завершении игры.
4. Отображается счётчик оставшихся мин:
    - рассчитывается как общее количество мин минус количество установленных флажков.
5. Отображается кнопка «Новая игра», сбрасывающая текущее поле.

---

## 3.5 Статистика

1. Сохраняются следующие показатели:
    - общее количество сыгранных игр;
    - количество побед;
    - количество поражений.
2. Статистика обновляется только после завершения игры.
3. Незавершённая игра не учитывается в статистике.
4. Пользователь может вручную сбросить статистику.

---

# 4. Нефункциональные требования

## 4.1 Производительность
1. Время первоначальной загрузки приложения — не более 3 секунд при скорости соединения 10 Мбит/с.
2. Время отклика интерфейса на действие пользователя — не более 100 мс.
3. Размер клиентского бандла — не более 1 МБ (без учёта кэша браузера).

---

## 4.2 Доступность

1. Интерфейс должен корректно отображаться на экранах шириной от 320 px.
2. Минимальный размер интерактивной области клетки на мобильных устройствах — 32 × 32 px.
3. Контраст текста и фона должен соответствовать WCAG 2.1 AA.
4. Игра должна корректно работать в портретной ориентации.
5. Все действия должны быть доступны с клавиатуры (стрелки — навигация, Enter — открыть, F — флажок).

---

## 4.3 Надёжность

1. Перезагрузка страницы приводит к сбросу текущей игры.
2. Статистика сохраняется между сессиями браузера.
3. Потеря интернет-соединения после загрузки страницы не влияет на текущую игру.

---

## 4.4 Совместимость

1. Приложение должно корректно работать в последних двух версиях основных браузеров.
2. Интерфейс должен быть адаптивным.

---

# 5. Бизнес-правила

1. Игра считается начатой при первом открытии клетки.
2. Игра считается завершённой при наступлении победы или поражения.
3. Одна игра может иметь только один итог.
4. Незавершённая игра не учитывается в статистике.
5. Статистика хранится локально и привязана к конкретному браузеру.
6. Первая открытая клетка всегда безопасна.

---

# 6. Ограничения

1. Не предусмотрена авторизация пользователей.
2. Не предусмотрена синхронизация статистики между устройствами.
3. Не предусмотрен многопользовательский режим.
4. Не предусмотрена таблица рекордов.
